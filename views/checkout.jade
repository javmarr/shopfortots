extends layout
div#addpage
  block content
    h1= title
    a(href='/') Home
    table(style="width:100%")
      tr
        th Toy 
        th Description
        th Price

      each item in items
        tr(class="singleItem" id="#{item._id}")
          td 
            img(src= '#{item.image}', style="width:128px;height:128px;")
          td #{item.title}
          td(id="price_#{item._id}" value="#{item.price}") $#{item.price}
          
    div#totalcartarea
      .container
        p#totalcart Total:
    
    form(action='/charge', method='POST')
      button(class='stripe-button-el')
        span(style='display: block; min-height: 30px') YO
        
    script.
      var total = 0;
      var list = $('.singleItem');
      for (var i = 0; i < list.length; i++) {
        addtotal = Number($('#price_'+list[i].id).attr('value'));
        total = total + addtotal;
        total = parseFloat(total.toFixed(2));
      }
      
      $(document).ready( function() {
        $('#totalcart').text('Total: $'+ total.toFixed(2)); 
        console.log($('#totalcart').text());
        
      })
      
      $('.stripe-button-el').click(){
        StripeCheckout.open({
          name: "Shop for tots",
          amount: total.toFixed(2)*100
        });
        
      }
